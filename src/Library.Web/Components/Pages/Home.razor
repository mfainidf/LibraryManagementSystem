@page "/"
@using Library.Web.Services
@inject WebAuthenticationService WebAuth
@inject NavigationManager Navigation
@rendermode @(new InteractiveServerRenderMode(prerender: false))

<PageTitle>Library Management System</PageTitle>

<div class="container-fluid vh-100 d-flex align-items-center justify-content-center bg-light">
    <div class="text-center">
        <div class="mb-4">
            <i class="fas fa-book fa-5x text-primary mb-3"></i>
            <h1 class="display-4 fw-bold text-primary">Library Management System</h1>
            <p class="lead text-muted">Manage your library catalog with ease</p>
        </div>
        
        @if (WebAuth.IsAuthenticated())
        {
            <div class="alert alert-success d-inline-block">
                <i class="fas fa-user-check"></i> Welcome back, @WebAuth.GetCurrentUser()?.Name!
            </div>
            <div class="mt-3">
                <a href="/dashboard" class="btn btn-primary btn-lg me-3">
                    <i class="fas fa-tachometer-alt"></i> Go to Dashboard
                </a>
                <button class="btn btn-outline-secondary" @onclick="Logout">
                    <i class="fas fa-sign-out-alt"></i> Logout
                </button>
            </div>
        }
        else
        {
            <div class="mt-4">
                <a href="/login" class="btn btn-primary btn-lg me-3">
                    <i class="fas fa-sign-in-alt"></i> Sign In
                </a>
                <a href="/register" class="btn btn-outline-success btn-lg">
                    <i class="fas fa-user-plus"></i> Register
                </a>
            </div>
            <div class="mt-3">
                <p class="text-muted">
                    <small>New to our system? Create an account to get started</small>
                </p>
            </div>
        }
    </div>
</div>

@code {
    protected override void OnInitialized()
    {
        // Auto-redirect authenticated users to dashboard
        if (WebAuth.IsAuthenticated())
        {
            Navigation.NavigateTo("/dashboard", forceLoad: true);
        }
    }

    private async Task Logout()
    {
        await WebAuth.LogoutAsync();
        StateHasChanged();
    }
}
